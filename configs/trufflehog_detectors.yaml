# TruffleHog Custom Detectors Configuration
# This file contains custom detector definitions for TruffleHog secret scanning
# Used by the SAT (Security Analysis Tool) TruffleHog integration

detectors:
  - name: DkeaToken
    description: "Databricks DKEA token detector"
    keywords:
      - dkea
    regex:
      id: (?i)\b(dkea[a-h0-9]{32})
    
  - name: DapiToken
    description: "Databricks DAPI token detector"
    keywords:
      - dapi
    regex:
      id: (?i)\b(dapi[a-h0-9]{32})
    
  - name: DoseToken
    description: "Databricks DOSE token detector"
    keywords:
      - dose
    regex:
      id: (?i)\b(dose[a-h0-9]{32})

# Configuration settings for TruffleHog scanning
settings:
  excluded_detectors:
    - DatabricksToken  # Exclude built-in Databricks token detector to avoid false positives
  
  scan_options:
    no_update: true
    json_output: true
    
  rate_limiting:
    api_sleep_seconds: 10  # Sleep between API calls to prevent rate limiting
    
  file_paths:
    temp_config: "/tmp/trufflehog_config.yaml"
    temp_notebooks: "/tmp/notebooks"
    results_log: "/tmp/trufflehog_scan_results.json"
    
  search_settings:
    page_size: 50
    days_back: 1  # Number of days back to search for modified notebooks
                  # Set to 0 to scan ALL notebooks (no time filter)
                  # Can be overridden by TIME environment variable (epoch milliseconds)
