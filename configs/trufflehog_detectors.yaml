# TruffleHog Custom Detectors Configuration
# This file contains custom detector definitions for TruffleHog secret scanning
# Used by the SAT (Security Analysis Tool) TruffleHog integration

detectors:
  - name: DkeaToken
    description: "Databricks DKEA token detector"
    keywords:
      - dkea
    regex:
      id: (?i)\b(dkea[a-h0-9]{32})
    
  - name: DapiToken
    description: "Databricks DAPI token detector"
    keywords:
      - dapi
    regex:
      id: (?i)\b(dapi[a-h0-9]{32})
    
  - name: DoseToken
    description: "Databricks DOSE token detector"
    keywords:
      - dose
    regex:
      id: (?i)\b(dose[a-h0-9]{32})
  
  - name: AWSAccessKey
    description: "AWS Access Key ID detector"
    keywords:
      - aws
      - akia
      - asia
    regex:
      accessKey: (AKIA|ASIA|ABIA|ACCA)[0-9A-Z]{16}
  
  - name: AWSSecretKey
    description: "AWS Secret Access Key detector"
    keywords:
      - aws
      - secret
    regex:
      secretKey: (?i)(?:aws_secret_access_key|aws_secret_key|secret_key|secretkey)[\s:=]+["\']?([A-Za-z0-9/+=]{40})["\']?

# Configuration settings for TruffleHog scanning
settings:
  excluded_detectors:
    - DatabricksToken  # Exclude built-in Databricks token detector to avoid false positives
  
  scan_options:
    no_update: true
    json_output: true
    
  rate_limiting:
    api_sleep_seconds: 10  # Sleep between API calls to prevent rate limiting
    
  file_paths:
    temp_config: "/tmp/trufflehog_config.yaml"
    temp_notebooks: "/tmp/notebooks"
    results_log: "/tmp/trufflehog_scan_results.json"
    
  search_settings:
    page_size: 50
    days_back: 1  # Number of days back to search for modified notebooks
