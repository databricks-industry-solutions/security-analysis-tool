id,check_id,category,check,evaluation_value,severity,recommendation,aws,azure,gcp,enable,alert,logic,api,aws_doc_url,azure_doc_url,gcp_doc_url
1,DP-1,Data Protection,Secrets management,1,Medium,Store and use secrets securely,1,1,1,1,0,Check if there are any secrets configured in the workspace by listing scopes and looking for the secrets count against the configured baseline value in those scopes,curl --netrc -X GET \ https://<workspace_url>/api/2.0/secrets/scopes/list,https://docs.databricks.com/security/secrets/index.html,https://learn.microsoft.com/en-us/azure/databricks/security/secrets/,https://docs.gcp.databricks.com/security/secrets/index.html
2,DP-2,Data Protection,Cluster instance disk encryption,-1,Low,All clusters should enable local disk encryption,1,1,0,1,0,Check if enable_local_disk_encryption is set as false for any cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list,https://docs.databricks.com/clusters/configure.html#local-disk-encryption,https://learn.microsoft.com/en-us/azure/databricks/clusters/configure#--local-disk-encryption,https://docs.gcp.databricks.com/clusters/configure.html#local-disk-encryption
3,DP-3,Data Protection,Customer-managed keys for managed services and workspace storage,-1,Low,Add a customer-managed key for managed services and workspace storage,1,0,0,1,0,Check if storage_customer_managed_key_id and managed_services_customer_managed_key_id are set for each workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/security/keys/customer-managed-keys-storage-aws.html,https://learn.microsoft.com/en-us/azure/databricks/security/keys/customer-managed-keys,N/A
4,DP-4,Data Protection,Object storage encryption for data sources,-1,High,Encrypt object storage data buckets and restrict access,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html,https://learn.microsoft.com/en-us/azure/storage/common/storage-service-encryption,https://cloud.google.com/storage/docs/encryption
5,DP-5,Data Protection,Downloading results is disabled,-1,Medium,Disable download button for notebook results,1,1,1,1,0,Check workspace-conf for enableResultsDownloading setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableResultsDownloading',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-download-results,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results
6,GOV-1,Governance,Cluster policies consistently applied,-1,High,Configure cluster policies to enforce data access patterns and control costs,1,1,1,1,0,Check if policy_id is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/administration-guide/clusters/policies.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/clusters/policies,https://docs.gcp.databricks.com/administration-guide/clusters/policies.html
7,GOV-2,Governance,PAT tokens are about to expire,7,High,Set an expiration day (maximum lifetime) for tokens. Also regularly review PAT tokens to avoid expired tokens.,1,1,1,1,0,Check each token expiry_time and report if the expiry_time is within configured days,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list | jq .,https://docs.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#manage-personal-access-tokens,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens
8,GOV-3,Governance,Log delivery configurations,-1,High,Configure Databricks audit log delivery (or see GOV-34),1,1,0,1,0,"Check account log-delivery configuration and look for audit log config with log_type set as ""AUDIT_LOGS"" and status set as ""ENABLED""",curl -netrc -X GET \ 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/log-delivery',https://docs.databricks.com/administration-guide/account-settings/audit-logs.html#configure-audit-log-delivery,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/audit-logs#configure-audit-log-delivery,https://docs.gcp.databricks.com/administration-guide/account-settings/audit-logs.html#configure-audit-log-delivery
9,GOV-4,Governance,Long-running clusters,24,Medium,Restart clusters on a regular schedule to use the latest available base image and container image.,1,1,1,1,0,Check each running cluster's last restart time till now and report on clusters that were running longer than the configured number of days without a restart,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/clusters-manage.html#restart-a-cluster-to-update-it-with-the-latest-images,https://learn.microsoft.com/en-us/azure/databricks/clusters/clusters-manage#--restart-a-cluster-to-update-it-with-the-latest-images,https://docs.gcp.databricks.com/clusters/clusters-manage.html#restart-a-cluster-to-update-it-with-the-latest-images
10,GOV-5,Governance,Deprecated versions of Databricks runtimes,-1,High,Deprecated runtime version detected. Please update your cluster runtimes to Databricks supported runtimes,1,1,1,1,0,List clusters with spark version that is not in the supported spark versions,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/spark-versions,https://docs.databricks.com/release-notes/runtime/releases.html,https://learn.microsoft.com/en-us/azure/databricks/release-notes/runtime/releases,https://docs.gcp.databricks.com/release-notes/runtime/releases.html
11,GOV-6,Governance,All-purpose cluster custom tags,-1,Low,Configure cluster tagging to monitor usage and enable chargebacks,1,1,1,0,0,check if custom_tags is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/usage-detail-tags-azure,https://docs.gcp.databricks.com/administration-guide/account-settings-gcp/usage-detail-tags-gcp.html
12,GOV-7,Governance,Job cluster custom tags,-1,Low,Configure job tagging to monitor usage and enable chargebacks,1,1,1,0,0,Check if settings.new_cluster.custom_tags is not null for job clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/usage-detail-tags-azure,https://docs.gcp.databricks.com/administration-guide/account-settings-gcp/usage-detail-tags-gcp.html
13,GOV-8,Governance,All-purpose cluster log configuration,-1,Low,Configure Databricks cluster log delivery,1,1,1,0,0,Check if cluster_log_conf is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://learn.microsoft.com/en-us/azure/databricks/clusters/configure#cluster-log-delivery,https://docs.gcp.databricks.com/clusters/configure.html#cluster-log-delivery-1
14,GOV-9,Governance,Job cluster log configuration,-1,Low,Configure Databricks job custer log delivery,1,1,1,0,0,Check if cluster_log_conf is set for job clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://learn.microsoft.com/en-us/azure/databricks/clusters/configure#cluster-log-delivery,https://docs.gcp.databricks.com/clusters/configure.html#cluster-log-delivery-1
15,GOV-10,Governance,Managed tables in DBFS root,1,Low,The DBFS root is not intended for production customer data,1,1,1,1,0,Check the /user/hive/warehouse/ folder for any data folders stored more than the configured value,"curl --netrc -X GET \ https://<workspace_url>/api/2.0/dbfs/list \ --data '{ ""path"": ""/user/hive/warehouse/"" }'",https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://learn.microsoft.com/en-us/azure/databricks/data/databricks-file-system#configuration-and-usage-recommendations,https://docs.gcp.databricks.com/dbfs/index.html#configuration-and-usage-recommendations
16,GOV-11,Governance,DBFS mounts,1,Low,Avoid DBFS mounts for accessing production data,1,1,1,1,0,Check for mnt paths in dbutils.fs.mounts() and report if there are datasources loaded as FUSE mounts to the workspace than the configured value,dbutils.fs.mounts(),https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://learn.microsoft.com/en-us/azure/databricks/data/databricks-file-system#configuration-and-usage-recommendations,https://docs.gcp.databricks.com/dbfs/index.html#configuration-and-usage-recommendations
17,GOV-12,Governance,Unity Catalog enabled clusters,-1,High,Use Unity Catalog enabled clusters,1,1,0,1,0,Check if there are clusters without data_security_mode as (USER_ISOLATION or SINGLE_USER) or data_security_mode as none,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/data-governance/unity-catalog/index.html#cluster-access-modes-for-unity-catalog,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/#cluster-access-modes-for-unity-catalog,https://docs.gcp.databricks.com/data-governance/unity-catalog/index.html#cluster-access-modes-for-unity-catalog
18,IA-1,Identity & Access,Enable single sign-on,-1,High,Authenticate via single sign-on and leverage multi-factor authentication,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.databricks.com/administration-guide/users-groups/single-sign-on/index.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/users-groups/single-sign-on/,https://docs.gcp.databricks.com/administration-guide/users-groups/single-sign-on/index.html
19,IA-2,Identity & Access,SCIM for user provisioning,-1,High,Provision users from your Identity Provider with workspace-level SCIM APIs,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.databricks.com/administration-guide/users-groups/scim/index.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/users-groups/scim/index,https://docs.gcp.databricks.com/administration-guide/users-groups/scim/index.html
20,IA-3,Identity & Access,Table Access Control for clusters that don't use Unity Catalog,-1,High,"For clusters that do not use Unity Catalog, enable Table Access Control in admin settings so that you can utilize Table ACL clusters that enforce user isolation",1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.databricks.com/administration-guide/access-control/table-acl.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/table-acl,https://docs.gcp.databricks.com/administration-guide/access-control/table-acl.html
21,IA-4,Identity & Access,PAT tokens with no lifetime (expiration) limit,90,Medium,Configure maximum token lifetimes for future tokens using token management,1,1,1,1,0,Check each token expiry_time and report if the expiry_time is not within the configured number of days or set to never expire by using -1 as the value,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list,https://docs.databricks.com/administration-guide/access-control/tokens.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#manage-personal-access-tokens,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html
22,INFO-1,Informational,Instance Pool custom tag,-1,Low,Configure tagging to monitor usage and enable chargebacks,1,1,1,1,0,Check if instance-pools have custom tags configured,curl --netrc -X GET \ https://<workspace_url>/api/2.0/instance-pools/list | jq .,https://docs.databricks.com/clusters/instance-pools/configure.html#pool-tags,https://learn.microsoft.com/en-us/azure/databricks/clusters/instance-pools/configure#pool-tags,https://docs.gcp.databricks.com/clusters/instance-pools/configure.html#pool-tags
23,INFO-2,Informational,Set maximum concurrent runs in job configuration,5,Low,Limit the number of parallel runs for a given job to avoid resource contention,1,1,1,1,0,Check if max_concurrent_runs configuration for each job is less than configured value,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/data-engineering/jobs/jobs.html#max-concurrent-runs,https://learn.microsoft.com/en-us/azure/databricks/data-engineering/jobs/jobs#max-concurrent-runs,https://docs.gcp.databricks.com/data-engineering/jobs/jobs.html#max-concurrent-runs
24,INFO-3,Informational,Global libraries,-1,Low,"Global libraries are discouraged for security reasons. Use cluster libraries or notebook-scoped libraries to improve startup time for clusters that don't require that library, and to improve flexibility where that library is not required.",1,1,1,1,0,Check if is_library_for_all_clusters is set as true for any library that is configured for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/libraries/all-cluster-statuses | jq .,https://docs.databricks.com/libraries/cluster-libraries.html,https://learn.microsoft.com/en-us/azure/databricks/libraries/cluster-libraries,https://docs.gcp.databricks.com/libraries/cluster-libraries.html
25,INFO-4,Informational,Number of users who have cluster create privileges,5,Low,Limit number of users with cluster create privileges. Note: the threshold for this SAT check can be configured.,1,1,1,1,0,"Check entitlements.value for each user and look if they have 'allow-cluster-create', 'allow-instance-pool-create' as permission, and count the number of users with such permissions to report if that crossed the configured threshold.",curl --netrc -X GET \ https://<workspace_url>/api/2.0/preview/scim/v2/Users,https://docs.databricks.com/security/access-control/cluster-acl.html,https://learn.microsoft.com/en-us/azure/databricks/security/access-control/cluster-acl,https://docs.gcp.databricks.com/security/access-control/cluster-acl.html
26,INFO-5,Informational,Global init script,-1,Medium,"Global init scripts are discouraged for security, improved startup and flexibility reasons",1,1,1,1,0,Check if there are any global-init-scripts configured,curl --netrc -X GET \ https://<workspace_url>/api/2.0/global-init-scripts,https://docs.databricks.com/clusters/init-scripts.html#init-script-types,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts#init-script-types,https://docs.gcp.databricks.com/clusters/init-scripts.html#global-init-scripts
27,INFO-6,Informational,Number of admins,2,Low,Limit the number of admin accounts so that most users are not admins. Note: the threshold for this SAT check can be configured,1,1,1,1,0,"Check members count of diplayName ""admins"" in groups to report if the count is more than the configured threshold",curl --netrc -X GET \ https://<workspace_url>/api/2.0/preview/scim/v2/Groups,https://docs.databricks.com/administration-guide/users-groups/users.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/users-groups/users,https://docs.gcp.databricks.com/administration-guide/users-groups/users.html
28,INFO-7,Informational,"Detect network peering of VPC (AWS, GCP) or VNet (Azure)",-1,Medium,"Network peering is discouraged because private endpoints are recommended. For example, AWS PrivateLink, Azure Private Link, or Google Private Service Connect.",1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject,https://cloud.google.com/vpc/docs/private-access-options
29,INFO-8,Informational,Job view ACLs are set consistently,-1,High,Use job visibility control to prevent users from viewing jobs where they do not have permissions,1,1,1,1,0,Check workspace-conf for enableJobViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableJobViewAcls',https://docs.databricks.com/administration-guide/access-control/jobs-acl.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/jobs-acl,https://docs.gcp.databricks.com/administration-guide/access-control/jobs-acl.html
30,INFO-9,Informational,Cluster view ACLs are set consistently,-1,High,Use cluster visibility control to prevent users from viewing clusters where they do not have permissions,1,1,1,1,0,Check workspace-conf for enforceClusterViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enforceClusterViewAcls',https://docs.databricks.com/security/access-control/cluster-acl.html,https://learn.microsoft.com/en-us/azure/databricks/security/access-control/cluster-acl,https://docs.gcp.databricks.com/security/access-control/cluster-acl.html
31,INFO-10,Informational,Workspace View ACLs are set consistently,-1,High,Use workspace visibility control to prevent users from viewing notebooks and other objects where they do not have permissions in the workspac,1,1,1,1,0,Check workspace-conf for enforceWorkspaceViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enforceWorkspaceViewAcls',https://docs.databricks.com/security/access-control/workspace-acl.html,https://learn.microsoft.com/en-us/azure/databricks/security/access-control/workspace-acl,https://docs.gcp.databricks.com/security/access-control/workspace-acl.html
32,INFO-11,Informational,Workspace for supporting Git repos,-1,High,It is recommended to store code in Git repos,1,1,1,1,0,Check workspace-conf for enableProjectTypeInWorkspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableProjectTypeInWorkspace',https://docs.databricks.com/repos/index.html,https://learn.microsoft.com/en-us/azure/databricks/repos/index,https://docs.gcp.databricks.com/repos/index.html
33,NS-1,Network Security,Public keys for all-purpose clusters,-1,High,"Remote SSH access to clusters is discouraged, use web terminal instead",1,1,1,1,0,Check if ssh_public_keys is configured on any cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/web-terminal.html,https://learn.microsoft.com/en-us/azure/databricks/clusters/web-terminal,https://docs.gcp.databricks.com/clusters/web-terminal.html
34,NS-2,Network Security,Public keys for job cluster,-1,High,"Remote SSH access to clusters is discouraged, use web terminal instead",1,1,1,1,0,Check if ssh_public_keys is configured on any job cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/clusters/web-terminal.html,https://learn.microsoft.com/en-us/azure/databricks/clusters/web-terminal,https://docs.gcp.databricks.com/clusters/web-terminal.html
35,NS-3,Network Security,Front-end private connectivity,-1,Medium,"Configure either private network connectivity or IP access lists (NS-5) for workspace access and REST APIs. You can configure AWS PrivateLink, Azure Private Link, or Google Private Service Connect. Note that enabling and requiring front-end private connectivity are different, see the documentation for details.",1,1,1,1,0,Check if private_access_settings_id is set for the workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/administration-guide/cloud-configurations/aws/privatelink.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/private-link,https://cloud.google.com/vpc/docs/private-access-options
36,NS-4,Network Security,"Workspace uses a customer-managed VPC (AWS, GCP) or enables VNet injection (Azure)",-1,Medium,"Deploy with a customer-managed VPC (AWS, GCP) or use VNet injection (Azure) to help enforce data exfiltration protections",1,1,1,1,0,Check if network_id is set for this workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/administration-guide/cloud-configurations/aws/customer-managed-vpc.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject,https://docs.gcp.databricks.com/administration-guide/cloud-configurations/gcp/customer-managed-vpc.html
37,NS-5,Network Security,IP access lists for workspace access,-1,Medium,Configure IP access lists or private network connectivity (NS-3) for workspaces that restrict the IP addresses that can authenticate to help protect against data exfiltration and account takeover,1,1,1,1,0,Check if ip-access-lists are configured and enabled,curl --netrc -X GET \ https://<workspace_url>/api/2.0/ip-access-lists,https://docs.databricks.com/security/network/ip-access-list.html#add-an-ip-access-list,https://learn.microsoft.com/en-us/azure/databricks/security/network/front-end/ip-access-list,https://docs.gcp.databricks.com/security/network/ip-access-list.html
38,IA-5,Identity & Access,Maximum lifetime of new tokens to something other than unlimited,-1,Medium,Configure maximum lifetime for all future tokens to a value other than unlimited,1,1,1,1,0,Check workspace-conf for maxTokenLifetimeDays In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=maxTokenLifetimeDays',https://docs.databricks.com/administration-guide/access-control/tokens.html#lifetime,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#--set-maximum-lifetime-of-new-tokens-rest-api-only,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html#lifetime
39,NS-6,Network Security,Secure cluster connectivity (on Azure this is also called NoPublicIp),-1,Medium,"Configure secure cluster connectivity (On Azure, this is called NoPublicIP / NPIP)",0,1,0,1,0,Check if enableNoPublicIp are configured and enabled,curl --netrc -X GET \ https://accounts.azuredatabricks.net/api/2.0/accounts/<account_id>/workspaces,N/A,https://learn.microsoft.com/en-us/azure/databricks/security/secure-cluster-connectivity,
40,GOV-13,Governance,Enforce User Isolation,-1,Medium,Enforce user isolation cluster types on a workspace,1,1,1,1,0,Check workspace-conf for enforceUserIsolation In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys= enforceUserIsolation',https://docs.databricks.com/security/enforce-user-isolation.html,https://learn.microsoft.com/en-us/azure/databricks/security/enforce-user-isolation,https://docs.gcp.databricks.com/security/enforce-user-isolation.html
41,IA-6,Identity & Access, Tokens with a lifetime (expiration) that exceeds the workspace maximum lifetime for new tokens,-1,Medium,Update lifetime for all old tokens,1,1,1,1,0,Compare workspace-conf for maxTokenLifetimeDays in workspace setting against all tokens expiration days,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list | jq .,https://docs.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#manage-personal-access-tokens,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens
42,IA-7,Identity & Access,Use service principals,1,Medium,Run production workloads with service principals,1,1,1,1,0,Check if at least one service principle exists for the workspace,curl --netrc -X GET \ https://<workspace_url>/api/2.0/preview/scim/v2/ServicePrincipals | jq .,https://docs.databricks.com/administration-guide/users-groups/service-principals.html,https://learn.microsoft.com/en-us/azure/databricks/tutorials/run-jobs-with-service-principalshttps://docs.gcp.databricks.com/administration-guide/users-groups/service-principals.html,https://docs.gcp.databricks.com/administration-guide/users-groups/service-principals.html
43,GOV-14,Governance,Enforce AWS Instance Metadata Service v2,-1,Low,Enforce AWS Instance Metadata Service v2 on a workspace,1,0,0,1,0,Check workspace-conf for enableEnforceImdsV2 In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys= enableEnforceImdsV2',https://docs.databricks.com/administration-guide/cloud-configurations/aws/imdsv2.html,,
44,DP-6,Data Protection,Notebook export,-1,Low,Disable exporting notebooks and cells within notebooks,1,1,1,1,0,Check workspace-conf for enableExportNotebook setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableExportNotebook',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-download-results,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results
45,DP-7,Data Protection,Notebook table clipboard features,-1,Low,Disable the ability of users to copy tabular data to the clipboard via the notebooks UI,1,1,1,1,0,Check workspace-conf for enableNotebookTableClipboard setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableNotebookTableClipboard',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-download-results,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results
46,INFO-12,Informational,Manage third-party iFraming prevention,-1,Low,Enable third-party iFraming prevention,1,1,1,0,0,Check workspace-conf for enable-X-Frame-Options In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enable-X-Frame-Options',https://docs.databricks.com/administration-guide/workspace/security.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/security,https://docs.gcp.databricks.com/administration-guide/workspace/security.html
47,INFO-13,Informational,Manage MIME type sniffing prevention,-1,Low,Enable MIME type sniffing prevention,1,1,1,0,0,Check workspace-conf for enable-X-Content-Type-Options In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enable-X-Content-Type-Options',https://docs.databricks.com/administration-guide/workspace/security.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/security,https://docs.gcp.databricks.com/administration-guide/workspace/security.html
48,INFO-14,Informational,Manage XSS attack page rendering prevention,-1,Low,Enable XSS attack page rendering prevention,1,1,1,0,0,Check workspace-conf for enable-X-XSS-Protection In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enable-X-XSS-Protection',https://docs.databricks.com/administration-guide/workspace/security.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/security,https://docs.gcp.databricks.com/administration-guide/workspace/security.html
49,DP-8,Data Protection,Enable storing interactive notebook results only in the customer account,-1,Medium,Enable store interactive notebook results in your account,1,1,1,1,0,Check workspace-conf for storeInteractiveNotebookResultsInCustomerAccount setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=storeInteractiveNotebookResultsInCustomerAccount',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-where-notebook-results-are-stored,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-where-notebook-results-are-stored,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-where-notebook-results-are-stored
50,GOV-15,Governance,"Enable verbose audit logs (on Azure, diagnostic logs)",-1,Medium,"Enable verbose audit logs (on Azure, diagnostic logs)",1,1,1,1,0,Check workspace-conf for enableVerboseAuditLogs setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableVerboseAuditLogs',https://docs.databricks.com/administration-guide/account-settings/audit-logs.html#configure-verbose-audit-logs,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/audit-logs#--configure-verbose-audit-logs,https://docs.gcp.databricks.com/administration-guide/account-settings/audit-logs.html#configure-verbose-audit-logs
51,DP-9,Data Protection,FileStore endpoint for HTTPS file serving,-1,Medium,Review and disable FileStore endpoint in admin console workspace settings,1,1,1,1,0,Check workspace-conf for enableFileStoreEndpoint setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableFileStoreEndpoint',https://docs.databricks.com/dbfs/filestore.html#filestore,https://learn.microsoft.com/en-us/azure/databricks/dbfs/filestore,https://docs.gcp.databricks.com/dbfs/filestore.html#filestore
52,INFO-15,Informational,Store code in Git for notebooks,-1,High,Enable git versioning for notebooks,1,1,1,0,0,Check workspace-conf for enableNotebookGitVersioning setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableNotebookGitVersioning',https://docs.databricks.com/repos/index.html,https://learn.microsoft.com/en-us/azure/databricks/repos/index,https://docs.gcp.databricks.com/repos/index.html
53,GOV-16,Governance,Workspace Unity Catalog metastore assignment,-1,Medium,Enable a workspace for Unity Catalog by assigning a Unity Catalog metastore,1,1,1,1,0,Check if current-metastore-assignment has the workspace assigned to metastore_id,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/current-metastore-assignment,https://docs.databricks.com/data-governance/unity-catalog/enable-workspaces.html,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/enable-workspaces,https://docs.gcp.databricks.com/data-governance/unity-catalog/enable-workspaces.html
54,GOV-17,Governance,Limit the lifetime (expiration) of metastore Delta Sharing recipient token,-1,High,Set the lifetime of Delta Sharing recipient tokens,1,1,1,1,0,Check if delta_sharing_recipient_token_lifetime_in_seconds is set less than 90 days where delta_sharing_scope is INTERNAL_AND_EXTERNAL,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/metastore_summary,https://docs.databricks.com/data-sharing/create-recipient.html#modify-the-recipient-token-lifetime,https://learn.microsoft.com/en-us/azure/databricks/data-sharing/create-recipient#modify-recipient-token-lifetime,https://docs.gcp.databricks.com/data-sharing/create-recipient.html#modify-the-recipient-token-lifetime
55,GOV-18,Governance,Delta Sharing IP access lists,-1,Medium,Configure Delta Sharing IP access lists to restrict recipient access to trusted IP addresses,1,1,1,1,0,"Check if ip_access_list is present on share recipients for authentication_type ""TOKEN""",curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/recipients,https://docs.databricks.com/data-sharing/access-list.html#use-ip-access-lists-to-restrict-delta-sharing-recipient-access-open-sharing,https://learn.microsoft.com/en-gb/azure/databricks/data-sharing/access-list,https://docs.gcp.databricks.com/data-sharing/create-recipient.html#security-considerations-for-tokens
56,GOV-19,Governance,Delta Sharing token expiration,-1,Medium,Establish a process for rotating credentials Delta sharing token,1,1,1,1,0,"Check if expiration_time on share recipients for tokens for share with authentication_type ""TOKEN""",curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/recipients,https://docs.databricks.com/data-sharing/create-recipient.html#security-considerations-for-tokens,https://learn.microsoft.com/en-us/azure/databricks/data-sharing/create-recipient#--security-considerations-for-tokens,https://docs.gcp.databricks.com/data-sharing/access-list.html#security-considerations-for-tokens
57,GOV-20,Governance,Existence of Unity Sharing metastores,-1,Low,Create a Unity Catalog metastore,1,1,1,1,0,Check if securable_type = 'METASTORE' exists in metasores,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/metastores,https://docs.databricks.com/data-governance/unity-catalog/create-metastore.html,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/create-metastore,https://docs.gcp.databricks.com/data-governance/unity-catalog/create-metastore.html
58,GOV-21,Governance,Delegation of the Unity Catalog metastore admin to a group,-1,High,Delegate metastore admin to a group who is not the account admin,1,1,1,1,0,Check if securable_type = 'METASTORE' and owner != created_by for a metastore,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/metastores,https://docs.databricks.com/data-governance/unity-catalog/manage-privileges/index.html#assign-a-metastore-admin,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/manage-privileges/#--assign-a-metastore-admin,https://docs.gcp.databricks.com/data-governance/unity-catalog/manage-privileges/index.html#assign-a-metastore-admin
59,GOV-22,Informational,Direct use of Unity Catalog metastore storage credentials,-1,Medium,Use external locations rather than using storage credentials directly,1,1,1,0,0,Check if securable_type = 'STORAGE_CREDENTIAL' for storage-credentials,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/storage-credentials,https://docs.databricks.com/data-governance/unity-catalog/manage-external-locations-and-credentials.html,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/manage-external-locations-and-credentials,https://docs.gcp.databricks.com/data-governance/unity-catalog/manage-external-locations-and-credentials.html
60,GOV-23,Governance,Unity Catalog enabled data warehouses,-1,Low,Enable data warehouses for Unity Catalog,1,1,1,1,0,Check if disable_uc = true on warehouses,curl --netrc -X GET \ https://<workspace_url>/api/2.0/sql/warehouses,https://docs.databricks.com/sql/admin/create-sql-warehouse.html#advanced-options,https://learn.microsoft.com/en-us/azure/databricks/sql/admin/create-sql-warehouse#--advanced-options,https://docs.gcp.databricks.com/sql/admin/create-sql-warehouse.html#advanced-options
61,INFO-17,Informational,Serverless compute,-1,Low,Enable Serverless compute,1,1,0,0,0,Check if enable_serverless_compute != true on warehouses,curl --netrc -X GET \ https://<workspace_url>/api/2.0/sql/config/warehouses,https://docs.databricks.com/sql/admin/serverless.html,https://learn.microsoft.com/en-us/azure/databricks/sql/admin/serverless,N/A
62,INFO-18,Informational,Users with Delta Sharing permissions to create a recipient or create a share,-1,Low,Limit who has CREATE_RECIPIENT and CREATE_SHARE permissions on metastore. Note: the threshold for this check is configurable.,1,1,1,1,0,Check who has  CREATE_RECIPIENT and CREATE_SHARE permission on the metastore,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/permissions/{securable_type}/{full_name},https://docs.databricks.com/data-sharing/create-recipient.html,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts#--migrate-from-legacy-to-new-global-init-scripts,https://docs.gcp.databricks.com/data-sharing/create-recipient.html
63,GOV-24,Governance,Legacy global init script,-1,High,Databricks recommends that you migrate legacy scripts to the new global init scripts framework and then disable legacy scripts,1,1,0,1,0,Check workspace-conf for enableDeprecatedGlobalInitScripts setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableDeprecatedGlobalInitScripts',https://docs.databricks.com/clusters/init-scripts.html#migrate-from-legacy-to-new-global-init-scripts,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts#--migrate-from-legacy-to-new-global-init-scripts,
64,GOV-25,Governance,Init scripts stored in DBFS,-1,High,Databricks recommends you avoid storing init scripts in /databricks/init location to avoid unexpected behavior,1,1,0,1,0,List DBFS /databricks/init for any files and report,"curl --netrc -X GET \ https://<workspace_url>/api/2.0/dbfs/list \ --data '{ ""path"": ""/databricks/init"" }'",https://docs.databricks.com/clusters/init-scripts.html#cluster-scoped-init-scripts,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts,N/A
65,GOV-26,Governance,Legacy cluster-named init scripts,-1,High,Databricks recommends that you migrate legacy cluster-named init scripts to the new cluster-scoped init scripts framework and then disable legacy cluster named init scripts,1,1,0,1,0,Check workspace-conf for enableDeprecatedClusterNamedInitScripts setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys= enableDeprecatedClusterNamedInitScripts',https://docs.databricks.com/clusters/init-scripts.html#cluster-scoped-init-scripts,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts,N/A
78,GOV-28,Governance,Govern model assets,-1,Medium,Manage model lifecycle in Unity Catalog,1,1,1,1,0,	List the registered models and check if there are any models in UC,curl -n -X GET 'https://<workspace_url>/api/2.1/unity-catalog/models',https://docs.databricks.com/en/machine-learning/manage-model-lifecycle/index.html,https://learn.microsoft.com/en-us/azure/databricks/machine-learning/manage-model-lifecycle/,https://docs.gcp.databricks.com/en/machine-learning/manage-model-lifecycle/index.html
89,NS-7,Network Security,Secure model serving endpoints,-1,High,Secure endpoints of the underlying models served as REST API endpoints using Private connectivity or IP Access Lists,1,1,0,1,0,Check if there are any model serving endpoints configured then check if IP Access lists or PL is deployed to prevent the endpoints from being accessed from the public internet,curl -n -X GET 'https://<workspace_url>/api/2.0/serving-endpoints',https://docs.databricks.com/en/machine-learning/model-serving/manage-serving-endpoints.html,https://learn.microsoft.com/en-us/azure/databricks/machine-learning/model-serving/manage-serving-endpoints,N/A
90,INFO-29,Informational,Streamline the usage and management of various large language model(LLM) providers,-1,Medium,Secure third-party models hosted outside of Databricks with Model Serving to streamline the usage and management of various large language model (LLM) providers such as OpenAI and Anthropic within an organization by storing API keys in one secure location,1,1,0,1,0,Check if there is not at least one EXTERNAL_MODEL in model serving endpoints configured and alert incase of none,curl -n -X GET 'https://<workspace_url>/api/2.0/serving-endpoints',https://docs.databricks.com/en/generative-ai/external-models/index.html,https://learn.microsoft.com/en-us/azure/databricks/generative-ai/external-models,N/A
101,DP-14,Data Protection,Store and retrieve embeddings securely,-1,Low,Store and retrieve embeddings securely using the Vector Search,1,1,0,1,0,List all the Vector Search endpoints and see if at least one endpoint is configured,curl -n -X GET 'https://<workspace_url>/api/2.0/vector-search/endpoints',https://docs.databricks.com/en/generative-ai/vector-search.html,https://learn.microsoft.com/en-us/azure/databricks/generative-ai/vector-search,N/A
103,INFO-37,Informational,Compliance security profile for new workspaces,-1,Low,Validate and deploy on a platform that has put in place controls to meet the unique compliance needs of highly regulated industries,1,0,0,1,0,Check if compliance security profile for new workspaces is enabled,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>//accounts/{accountid}/settings/types/shield_csp_enablement_ac/names/default',https://docs.databricks.com/en/security/privacy/security-profile.html,https://learn.microsoft.com/en-us/azure/databricks/security/privacy/security-profile,N/A 
104,INFO-38,Informational,Third-party library control,-1,Low,Add libraries and init scripts to the allowlist in Unity Catalog,1,1,1,1,0,Get the artifact allowlist of and check if any allowed artifacts are configured,curl -n -X GET 'https://<workspace_url>/api/2.1/unity-catalog/artifact-allowlists/{artifact_type},https://docs.databricks.com/en/data-governance/unity-catalog/manage-privileges/allowlist.html,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/manage-privileges/allowlist,https://docs.gcp.databricks.com/en/data-governance/unity-catalog/manage-privileges/allowlist.html
105,GOV-34,Governance,Monitor audit logs with system tables (or see GOV-3),-1,High,Configure system tables and set up automated monitoring and alerting,1,1,1,1,0,Get the the systemschemas for the metastores and see if the access schema is enabled,curl -n -X GET 'https://<workspace_url>/api/2.0/unity-catalog/metastores/<metastore-id>/systemschemas',https://docs.databricks.com/en/admin/system-tables/index.html,https://learn.microsoft.com/en-us/azure/databricks/admin/system-tables/,https://docs.gcp.databricks.com/en/admin/system-tables/index.html
106,GOV-35,Governance,Restrict workspace admins,-1,Medium,Restrict workspace admins to only change a job owner to themselves and the job run as setting to a service principal that they have the Service Principal User role on,1,1,1,1,0,Get the restrict workspace admins setting and check if RestrictWorkspaceAdmins set to ALLOW_ALL,curl -n -X GET 'https://<workspace_url>/api/2.0/settings/types/restrict_workspace_admins/names/default',https://docs.databricks.com/en/admin/workspace-settings/restrict-workspace-admins.html,https://learn.microsoft.com/en-us/azure/databricks/admin/workspace-settings/restrict-workspace-admins,https://docs.gcp.databricks.com/en/admin/workspace-settings/restrict-workspace-admins.html
107,GOV-36,Governance,Automatic cluster update,-1,Medium,Ensure that all the clusters in a workspace are periodically updated to the latest host OS image and security updates,1,1,0,1,0,Get the automatic cluster update setting and check the value is set to true,curl --netrc -X GET \ https://<workspace_url>/api/2.0/settings/types/automatic_cluster_update/names/default \ | jq,https://docs.databricks.com/en/admin/clusters/automatic-cluster-update.html,https://learn.microsoft.com/en-us/azure/databricks/admin/clusters/automatic-cluster-update,N/A
108,INFO-39,Informational,Compliance security profile for the workspace,-1,Low,Validate and deploy on a platform that has put in place controls to meet the unique compliance needs of highly regulated industries,1,1,0,1,0,Check if compliance security profile for new workspaces is enabled,curl -n -X GET 'https:///<workspace_url>/api/2.0/settings/types/shield_csp_enablement_ws_db/names/default',https://docs.databricks.com/en/security/privacy/security-profile.html,https://learn.microsoft.com/en-us/azure/databricks/security/privacy/security-profile,N/A
109,INFO-40,Informational,Enhanced security monitoring for the workspace,-1,Low,Validate and deploy on a platform that has put in place controls to meet the unique compliance needs of highly regulated industries,1,1,0,1,0,Check if compliance security profile for new workspaces is enabled,curl -n -X GET 'https:///<workspace_url>api/2.0/settings/types/shield_esm_enablement_ws_db/names/default',https://docs.databricks.com/en/security/privacy/enhanced-security-monitoring.html,https://learn.microsoft.com/en-us/azure/databricks/security/privacy/enhanced-security-monitoring,N/A
