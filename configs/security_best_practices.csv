id,check_id,category,check,evaluation_value,severity,recommendation,aws,azure,gcp,enable,alert,logic,api,aws_doc_url,azure_doc_url,gcp_doc_url
1,DP-1,Data Protection,Secrets management,1,Medium,Store and use secrets securely,1,1,1,1,0,Check if there are any secrets configured in the workspace by listing scopes and looking for the secrets count against the configured baseline value in those scopes,curl --netrc -X GET \ https://<workspace_url>/api/2.0/secrets/scopes/list,https://docs.databricks.com/security/secrets/index.html,https://learn.microsoft.com/en-us/azure/databricks/security/secrets/,https://docs.gcp.databricks.com/security/secrets/index.html
2,DP-2,Data Protection,Cluster encryption,-1,Low,All clusters should enable local disk encryption,1,1,0,1,0,Check if enable_local_disk_encryption is set as false for any cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list,https://docs.databricks.com/clusters/configure.html#local-disk-encryption,https://learn.microsoft.com/en-us/azure/databricks/clusters/configure#--local-disk-encryption,https://docs.gcp.databricks.com/clusters/configure.html#local-disk-encryption
3,DP-3,Data Protection,BYOK,-1,Low,Add a customer-managed key for managed services and workspace storage,1,0,0,1,0,Check if storage_customer_managed_key_id and managed_services_customer_managed_key_id are set for each workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/security/keys/customer-managed-keys-storage-aws.html,https://learn.microsoft.com/en-us/azure/databricks/security/keys/customer-managed-keys,N/A
4,DP-4,Data Protection,Object storage encryption,-1,High,Encrypt object storage data buckets and restrict access,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html,https://learn.microsoft.com/en-us/azure/storage/common/storage-service-encryption,https://cloud.google.com/storage/docs/encryption
5,DP-5,Data Protection,Results downloading,-1,High,Disable download button for notebook results,1,1,1,1,0,Check workspace-conf for enableResultsDownloading setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableResultsDownloading',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-download-results,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results
6,GOV-1,Governance,Cluster policies,-1,High,Configure cluster policies to enforce data access patterns and control costs,1,1,1,1,0,Check if policy_id is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/administration-guide/clusters/policies.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/clusters/policies,https://docs.gcp.databricks.com/administration-guide/clusters/policies.html
7,GOV-2,Governance,PAT Tokens about to expire,7,High,"Set lifetime limit, but also regularly review PAT tokens to avoid expired tokens impacting authentications",1,1,1,1,0,Check each token expiry_time and report if the expiry_time is within configured days,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list | jq .,https://docs.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#manage-personal-access-tokens,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens
8,GOV-3,Governance,Log delivery configurations,-1,High,Configure Databricks audit log delivery,1,1,1,1,0,"Check account log-delivery configuration and look for audit log config with log_type set as ""AUDIT_LOGS"" and status set as ""ENABLED""",curl -netrc -X GET \ 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/log-delivery',https://docs.databricks.com/administration-guide/account-settings/audit-logs.html#configure-audit-log-delivery,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/audit-logs#configure-audit-log-delivery,https://docs.gcp.databricks.com/administration-guide/account-settings/audit-logs.html#configure-audit-log-delivery
9,GOV-4,Governance,Long running clusters,24,Medium,Automatically restart long running clusters,1,1,1,1,0,Check each running cluster's last restart time till now and report on clusters that were running longer than the configured number of days without a restart,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/clusters-manage.html#restart-a-cluster-to-update-it-with-the-latest-images,https://learn.microsoft.com/en-us/azure/databricks/clusters/clusters-manage#--restart-a-cluster-to-update-it-with-the-latest-images,https://docs.gcp.databricks.com/clusters/clusters-manage.html#restart-a-cluster-to-update-it-with-the-latest-images
10,GOV-5,Governance,Deprecated runtime versions,-1,High,Deprecated runtime version detected. Please update your cluster runtimes to Databricks supported runtimes,1,1,1,1,0,List clusters with spark version that is not in the supported spark versions,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/spark-versions,https://docs.databricks.com/release-notes/runtime/releases.html,https://learn.microsoft.com/en-us/azure/databricks/release-notes/runtime/releases,https://docs.gcp.databricks.com/release-notes/runtime/releases.html
11,GOV-6,Governance,All Purpose Cluster custom tags,-1,Low,Configure cluster tagging to monitor usage and enable charge-back,1,1,1,1,0,check if custom_tags is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/usage-detail-tags-azure,https://docs.gcp.databricks.com/administration-guide/account-settings-gcp/usage-detail-tags-gcp.html
12,GOV-7,Governance,Job Cluster custom tags,-1,Low,Configure job tagging to monitor usage and enable charge-back,1,1,1,1,0,Check if settings.new_cluster.custom_tags is not null for job clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/administration-guide/account-settings/usage-detail-tags-aws.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/usage-detail-tags-azure,https://docs.gcp.databricks.com/administration-guide/account-settings-gcp/usage-detail-tags-gcp.html
13,GOV-8,Governance,All Purpose Cluster log configuration,-1,Low,Configure Databricks cluster log delivery,1,1,1,1,0,Check if cluster_log_conf is set for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://learn.microsoft.com/en-us/azure/databricks/clusters/configure#cluster-log-delivery,https://docs.gcp.databricks.com/clusters/configure.html#cluster-log-delivery-1
14,GOV-9,Governance,Job Cluster log configuration,-1,Low,Configure Databricks job custer log delivery,1,1,1,1,0,Check if cluster_log_conf is set for job clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/clusters/configure.html#cluster-log-delivery-1,https://learn.microsoft.com/en-us/azure/databricks/clusters/configure#cluster-log-delivery,https://docs.gcp.databricks.com/clusters/configure.html#cluster-log-delivery-1
15,GOV-10,Governance,Managed Tables,1,Low,The DBFS root is not intended for production customer data,1,1,1,1,0,Check the /user/hive/warehouse/ folder for any data folders stored more than the configured value,"curl --netrc -X GET \ https://<workspace_url>/api/2.0/dbfs/list \ --data '{ ""path"": ""/user/hive/warehouse/"" }'",https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://learn.microsoft.com/en-us/azure/databricks/data/databricks-file-system#configuration-and-usage-recommendations,https://docs.gcp.databricks.com/dbfs/index.html#configuration-and-usage-recommendations
16,GOV-11,Governance,Mounts,1,Low,Avoid FUSE mounts for accessing production data,1,1,1,1,0,Check for mnt paths in dbutils.fs.mounts() and report if there are datasources loaded as FUSE mounts to the workspace than the configured value,dbutils.fs.mounts(),https://docs.databricks.com/data/databricks-file-system.html#configuration-and-usage-recommendations,https://learn.microsoft.com/en-us/azure/databricks/data/databricks-file-system#configuration-and-usage-recommendations,https://docs.gcp.databricks.com/dbfs/index.html#configuration-and-usage-recommendations
17,GOV-12,Governance,UC enabled clusters,-1,High,Use UC enabled clusters,1,1,0,1,0,Check if there are clusters without data_security_mode as (USER_ISOLATION or SINGLE_USER) or data_security_mode as none,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/data-governance/unity-catalog/index.html#cluster-access-modes-for-unity-catalog,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/#cluster-access-modes-for-unity-catalog,https://docs.gcp.databricks.com/data-governance/unity-catalog/index.html#cluster-access-modes-for-unity-catalog
18,IA-1,Identity & Access,SSO,-1,High,Authenticate via single sign-on and leverage multi-factor authentication,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.databricks.com/administration-guide/users-groups/single-sign-on/index.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/users-groups/single-sign-on/,https://docs.gcp.databricks.com/administration-guide/users-groups/single-sign-on/index.html
19,IA-2,Identity & Access,SCIM,-1,High,Keep an up-to-date user list by using SCIM,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.databricks.com/administration-guide/users-groups/scim/index.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/users-groups/scim/index,https://docs.gcp.databricks.com/administration-guide/users-groups/scim/index.html
20,IA-3,Identity & Access,Table Access Control,-1,High,Enable Table Access Control in admin settings so that you can utilize Table ACL clusters that enforce user isolation,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.databricks.com/administration-guide/access-control/table-acl.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/table-acl,https://docs.gcp.databricks.com/administration-guide/access-control/table-acl.html
21,IA-4,Identity & Access,PAT Tokens with no lifetime limit,-1,Medium,Configure maximum token lifetimes for future tokens using token management,1,1,1,1,0,Check each token expiry_time and report if the expiry_time is not within the configured number of days or set to never expire by using -1 as the value,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list,https://docs.databricks.com/administration-guide/access-control/tokens.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#manage-personal-access-tokens,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html
22,INFO-1,Informational,Instance Pool custom tag,-1,Low,Configure tagging to monitor usage and enable charge-back,1,1,1,1,0,Check if instance-pools have custom tags configured,curl --netrc -X GET \ https://<workspace_url>/api/2.0/instance-pools/list | jq .,https://docs.databricks.com/clusters/instance-pools/configure.html#pool-tags,https://learn.microsoft.com/en-us/azure/databricks/clusters/instance-pools/configure#pool-tags,https://docs.gcp.databricks.com/clusters/instance-pools/configure.html#pool-tags
23,INFO-2,Informational,Max concurrent runs,5,Low,Limit the number of parallel runs for a given job to avoid resource contention,1,1,1,1,0,Check if max_concurrent_runs configuration for each job is less than configured value,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/data-engineering/jobs/jobs.html#max-concurrent-runs,https://learn.microsoft.com/en-us/azure/databricks/data-engineering/jobs/jobs#max-concurrent-runs,https://docs.gcp.databricks.com/data-engineering/jobs/jobs.html#max-concurrent-runs
24,INFO-3,Informational,Global libraries,-1,Low,"Global libraries are discouraged for security reasons. Use cluster libraries or notebook-scoped libraries to improve startup time for clusters that don't require that library, and to improve flexibility where that library is not required.",1,1,1,1,0,Check if is_library_for_all_clusters is set as true for any library that is configured for clusters,curl --netrc -X GET \ https://<workspace_url>/api/2.0/libraries/all-cluster-statuses | jq .,https://docs.databricks.com/libraries/cluster-libraries.html,https://learn.microsoft.com/en-us/azure/databricks/libraries/cluster-libraries,https://docs.gcp.databricks.com/libraries/cluster-libraries.html
25,INFO-4,Informational,User Privileges,5,Low,Limit number of users with cluster create privileges,1,1,1,1,0,"Check entitlements.value for each user and look if they have 'allow-cluster-create', 'allow-instance-pool-create' as permission, and count the number of users with such permissions to report if that crossed the configured threshold.",curl --netrc -X GET \ https://<workspace_url>/api/2.0/preview/scim/v2/Users,https://docs.databricks.com/security/access-control/cluster-acl.html,https://learn.microsoft.com/en-us/azure/databricks/security/access-control/cluster-acl,https://docs.gcp.databricks.com/security/access-control/cluster-acl.html
26,INFO-5,Informational,Global Init Script,-1,Medium,"Global init scripts are discouraged for security, improved startup and flexibility reasons",1,1,1,1,0,Check if there are any global-init-scripts configured,curl --netrc -X GET \ https://<workspace_url>/api/2.0/global-init-scripts,https://docs.databricks.com/clusters/init-scripts.html#init-script-types,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts#init-script-types,https://docs.gcp.databricks.com/clusters/init-scripts.html#global-init-scripts
27,INFO-6,Informational,Admin Count,2,Low,Limit the number of admin accounts so that most users are not admins,1,1,1,1,0,"Check members count of diplayName ""admins"" in groups to report if the count is more than the configured threshold",curl --netrc -X GET \ https://<workspace_url>/api/2.0/preview/scim/v2/Groups,https://docs.databricks.com/administration-guide/users-groups/users.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/users-groups/users,https://docs.gcp.databricks.com/administration-guide/users-groups/users.html
28,INFO-7,Informational,VPC (or VNET) Peering,-1,Medium,VPC (or VNET) endpoints or Private Link are recommended,1,1,1,1,0,Manual check (Update cofiguration status using <SATProject>/notebooks/Setup/8. update_workspace_configuration notebook),Manual check,https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject,https://cloud.google.com/vpc/docs/private-access-options
29,INFO-8,Informational,Job View Acls,-1,High,Use Job Visibility Control to prevent users from viewing jobs where they do not have permissions,1,1,1,1,0,Check workspace-conf for enableJobViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableJobViewAcls',https://docs.databricks.com/administration-guide/access-control/jobs-acl.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/jobs-acl,https://docs.gcp.databricks.com/administration-guide/access-control/jobs-acl.html
30,INFO-9,Informational,Cluster View Acls,-1,High,Use Cluster Visibility Control to prevent users from viewing clusters where they do not have permissions,1,1,1,1,0,Check workspace-conf for enforceClusterViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enforceClusterViewAcls',https://docs.databricks.com/security/access-control/cluster-acl.html,https://learn.microsoft.com/en-us/azure/databricks/security/access-control/cluster-acl,https://docs.gcp.databricks.com/security/access-control/cluster-acl.html
31,INFO-10,Informational,Workspace View Acls,-1,High,Use Workspace Visibility Control to prevent users from viewing notebooks and other objects where they do not have permissions in the workspace,1,1,1,1,0,Check workspace-conf for enforceWorkspaceViewAcls setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enforceWorkspaceViewAcls',https://docs.databricks.com/security/access-control/workspace-acl.html,https://learn.microsoft.com/en-us/azure/databricks/security/access-control/workspace-acl,https://docs.gcp.databricks.com/security/access-control/workspace-acl.html
32,INFO-11,Informational,Project Type In Workspace,-1,High,It is recommended to store code in Git repos,1,1,1,1,0,Check workspace-conf for enableProjectTypeInWorkspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableProjectTypeInWorkspace',https://docs.databricks.com/repos/index.html,https://learn.microsoft.com/en-us/azure/databricks/repos/index,https://docs.gcp.databricks.com/repos/index.html
33,NS-1,Network Security,All Purpose Cluster Public Keys,-1,High,"Remote SSH access to clusters is discouraged, use web terminal instead",1,1,1,1,0,Check if ssh_public_keys is configured on any cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/clusters/list \ | jq .,https://docs.databricks.com/clusters/web-terminal.html,https://learn.microsoft.com/en-us/azure/databricks/clusters/web-terminal,https://docs.gcp.databricks.com/clusters/web-terminal.html
34,NS-2,Network Security,Job Cluster Public Keys,-1,High,"Remote SSH access to clusters is discouraged, use web terminal instead",1,1,1,1,0,Check if ssh_public_keys is configured on any job cluster,curl --netrc -X GET \ https://<workspace_url>/api/2.0/jobs/list \ | jq,https://docs.databricks.com/clusters/web-terminal.html,https://learn.microsoft.com/en-us/azure/databricks/clusters/web-terminal,https://docs.gcp.databricks.com/clusters/web-terminal.html
35,NS-3,Network Security,Private Link,-1,High,Configure private network connectivity,1,1,1,1,0,Check if private_access_settings_id is set for the workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/administration-guide/cloud-configurations/aws/privatelink.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/private-link,https://cloud.google.com/vpc/docs/private-access-options
36,NS-4,Network Security,BYOVPC (or  BYO Vnet or Vnet Injection),-1,Medium,Deploy with a customer-managed VPC ( BYO Vnet or Vnet Injection)to allow implementation of data exfiltration protections and VPC endpoints,1,1,1,1,0,Check if network_id is set for this workspace,curl -n -X GET 'https://accounts.cloud.databricks.com/api/2.0/accounts/<account_id>/workspaces',https://docs.databricks.com/administration-guide/cloud-configurations/aws/customer-managed-vpc.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject,https://docs.gcp.databricks.com/administration-guide/cloud-configurations/gcp/customer-managed-vpc.html
37,NS-5,Network Security,IP Access List,-1,Medium,Configure IP access lists that restrict the IP addresses that can authenticate to Databricks to protect against data exfiltration and account takeover,1,1,1,1,0,Check if ip-access-lists are configured and enabled,curl --netrc -X GET \ https://<workspace_url>/api/2.0/ip-access-lists,https://docs.databricks.com/security/network/ip-access-list.html#add-an-ip-access-list,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#--set-maximum-lifetime-of-new-tokens-rest-api-only,https://docs.gcp.databricks.com/security/network/ip-access-list.html
38,IA-5,Identity & Access,Maximum lifetime of new tokens,-1,Medium,Configure maximum lifetime for all future tokens,1,1,1,1,0,Check workspace-conf for maxTokenLifetimeDays In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=maxTokenLifetimeDays',https://docs.databricks.com/administration-guide/access-control/tokens.html#lifetime,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#--set-maximum-lifetime-of-new-tokens-rest-api-only,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html#lifetime
39,NS-6,Network Security,Secure cluster connectivity,-1,Medium,Configure Secure cluster connectivity (No Public IP / NPIP),0,1,0,1,0,Check if enableNoPublicIp are configured and enabled,curl --netrc -X GET \ https://accounts.azuredatabricks.net/api/2.0/accounts/<account_id>/workspaces,N/A,https://learn.microsoft.com/en-us/azure/databricks/security/secure-cluster-connectivity,
40,GOV-13,Governance,Enforce User Isolation,-1,Medium,Enforce user isolation cluster types on a workspace,1,1,1,1,0,Check workspace-conf for enforceUserIsolation In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys= enforceUserIsolation',https://docs.databricks.com/security/enforce-user-isolation.html,https://learn.microsoft.com/en-us/azure/databricks/security/enforce-user-isolation,https://docs.gcp.databricks.com/security/enforce-user-isolation.html
41,IA-6,Identity & Access,Tokens with a lifetime more than the maximum lifetime set,-1,Medium,Update maximum lifetime for all old tokens,1,1,1,1,0,Compare workspace-conf for maxTokenLifetimeDays in workspace setting against all tokens expiration days,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list | jq .,https://docs.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/access-control/tokens#manage-personal-access-tokens,https://docs.gcp.databricks.com/administration-guide/access-control/tokens.html#manage-personal-access-tokens
42,IA-7,Identity & Access,Use service principals,1,Medium,Run production workloads with service principals,1,1,1,1,0,Compare workspace-conf for maxTokenLifetimeDays in workspace setting against all tokens expiration days,curl --netrc -X GET \ https://<workspace_url>/api/2.0/token/list | jq .,https://docs.databricks.com/administration-guide/users-groups/service-principals.html,https://learn.microsoft.com/en-us/azure/databricks/tutorials/run-jobs-with-service-principalshttps://docs.gcp.databricks.com/administration-guide/users-groups/service-principals.html,https://docs.gcp.databricks.com/administration-guide/users-groups/service-principals.html
43,GOV-14,Governance,Enable Enforce ImdsV2,-1,Low,Enforce AWS Instance Metadata Service v2 on a workspace,1,0,0,1,0,Check workspace-conf for enableEnforceImdsV2 In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys= enableEnforceImdsV2',https://docs.databricks.com/administration-guide/cloud-configurations/aws/imdsv2.html,,
44,DP-6,Data Protection,Notebook export,-1,Low,Disable exporting notebooks and cells within notebooks,1,1,1,1,0,Check workspace-conf for enableExportNotebook setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableExportNotebook',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-download-results,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results
45,DP-7,Data Protection,Notebook Table Clipboard Features,-1,Low,Disable the ability of users to copy tabular data to the clipboard via the Notebooks UI,1,1,1,1,0,Check workspace-conf for enableNotebookTableClipboard setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableNotebookTableClipboard',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-download-results,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-download-results
46,INFO-12,Informational,Manage third-party iFraming prevention,-1,Low,Enable third-party iFraming prevention,1,1,1,1,0,Check workspace-conf for enable-X-Frame-Options In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enable-X-Frame-Options',https://docs.databricks.com/administration-guide/workspace/security.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/security,https://docs.gcp.databricks.com/administration-guide/workspace/security.html
47,INFO-13,Informational,Manage MIME type sniffing prevention,-1,Low,Enable MIME type sniffing prevention,1,1,1,1,0,Check workspace-conf for enable-X-Content-Type-Options In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enable-X-Content-Type-Options',https://docs.databricks.com/administration-guide/workspace/security.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/security,https://docs.gcp.databricks.com/administration-guide/workspace/security.html
48,INFO-14,Informational,Manage XSS attack page rendering prevention,-1,Low,Enable XSS attack page rendering prevention,1,1,1,1,0,Check workspace-conf for enable-X-XSS-Protection In Workspace setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enable-X-XSS-Protection',https://docs.databricks.com/administration-guide/workspace/security.html,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/security,https://docs.gcp.databricks.com/administration-guide/workspace/security.html
49,DP-8,Data Protection,Store Interactive Notebook Results in Customer Account,-1,Medium,Enable store interactive notebook results in your account,1,1,1,1,0,Check workspace-conf for storeInteractiveNotebookResultsInCustomerAccount setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=storeInteractiveNotebookResultsInCustomerAccount',https://docs.databricks.com/administration-guide/workspace/notebooks.html#manage-where-notebook-results-are-stored,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/workspace/notebooks#manage-where-notebook-results-are-stored,https://docs.gcp.databricks.com/administration-guide/workspace/notebooks.html#manage-where-notebook-results-are-stored
50,GOV-15,Governance,Enable verbose audit logs,-1,Medium,Enable verbose audit logs,1,1,1,1,0,Check workspace-conf for enableVerboseAuditLogs setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableVerboseAuditLogs',https://docs.databricks.com/administration-guide/account-settings/audit-logs.html#configure-verbose-audit-logs,https://learn.microsoft.com/en-us/azure/databricks/administration-guide/account-settings/audit-logs#--configure-verbose-audit-logs,https://docs.gcp.databricks.com/administration-guide/account-settings/audit-logs.html#configure-verbose-audit-logs
51,DP-9,Data Protection,FileStore endpoint,-1,Medium,Review and disable FileStore endpoint in Admin Console Workspace settings,1,1,1,1,0,Check workspace-conf for enableFileStoreEndpoint setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableFileStoreEndpoint',https://docs.databricks.com/dbfs/filestore.html#filestore,https://learn.microsoft.com/en-us/azure/databricks/dbfs/filestore,https://docs.gcp.databricks.com/dbfs/filestore.html#filestore
52,INFO-15,Informational,Store code in Git,-1,High,Enable git versioning for notebooks,1,1,1,1,0,Check workspace-conf for enableNotebookGitVersioning setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableNotebookGitVersioning',https://docs.databricks.com/repos/index.html,https://learn.microsoft.com/en-us/azure/databricks/repos/index,https://docs.gcp.databricks.com/repos/index.html
53,GOV-16,Governance,Workspace Unity Catalog metastore assignment,-1,Medium,Enable a workspace for Unity Catalog by assigning a Unity Catalog metastore,1,1,1,1,0,Check if current-metastore-assignment has the workspace assigned to metastore_id,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/current-metastore-assignment,https://docs.databricks.com/data-governance/unity-catalog/enable-workspaces.html,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/enable-workspaces,https://docs.gcp.databricks.com/data-governance/unity-catalog/enable-workspaces.html
54,GOV-17,Governance,Lifetime of metastore delta sharing recipient token,-1,High,Set the lifetime of delta sharing recipient tokens,1,1,1,1,0,Check if delta_sharing_recipient_token_lifetime_in_seconds is set less than 90 days where delta_sharing_scope is INTERNAL_AND_EXTERNAL ,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/metastore_summary,https://docs.databricks.com/data-sharing/create-recipient.html#modify-the-recipient-token-lifetime,https://learn.microsoft.com/en-us/azure/databricks/data-sharing/create-recipient#modify-recipient-token-lifetime,https://docs.gcp.databricks.com/data-sharing/create-recipient.html#modify-the-recipient-token-lifetime
55,GOV-18,Governance,Delta sharing IP Access Lists,-1,Medium,Configure Delta Sharing IP access lists to restrict recipient access to trusted IP addresses,1,1,1,1,0,"Check if ip_access_list is present on share recipients for authentication_type ""TOKEN""",curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/recipients,https://docs.databricks.com/data-sharing/access-list.html#use-ip-access-lists-to-restrict-delta-sharing-recipient-access-open-sharing,https://learn.microsoft.com/en-gb/azure/databricks/data-sharing/access-list,https://docs.gcp.databricks.com/data-sharing/create-recipient.html#security-considerations-for-tokens
56,GOV-19,Governance,Delta sharing Token Expiration,-1,Medium,Establish a process for rotating credentials Delta sharing Token,1,1,1,1,0,"Check if expiration_time on share recipients for tokens for share with authentication_type ""TOKEN""",curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/recipients,https://docs.databricks.com/data-sharing/create-recipient.html#security-considerations-for-tokens,https://learn.microsoft.com/en-us/azure/databricks/data-sharing/create-recipient#--security-considerations-for-tokens,https://docs.gcp.databricks.com/data-sharing/access-list.html#security-considerations-for-tokens
57,GOV-20,Governance,Use of Metastore,-1,Low,Create a Unity Catalog metastore,1,1,1,1,0,Check if securable_type = 'METASTORE' exists in metasores,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/metastores,https://docs.databricks.com/data-governance/unity-catalog/create-metastore.html,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/create-metastore,https://docs.gcp.databricks.com/data-governance/unity-catalog/create-metastore.html
58,GOV-21,Governance,Metastore Admin,-1,High,Delegate metastore admin to a group who is not the account admin,1,1,1,1,0,Check if securable_type = 'METASTORE' and owner != created_by for a metastore,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/metastores,https://docs.databricks.com/data-governance/unity-catalog/manage-privileges/index.html#assign-a-metastore-admin,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/manage-privileges/#--assign-a-metastore-admin,https://docs.gcp.databricks.com/data-governance/unity-catalog/manage-privileges/index.html#assign-a-metastore-admin
59,GOV-22,Informational,Metastore Storage Credentials,-1,Medium,Use external locations rather than using storage credentials directly,1,1,1,0,0,Check if securable_type = 'STORAGE_CREDENTIAL' for storage-credentials ,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/storage-credentials,https://docs.databricks.com/data-governance/unity-catalog/manage-external-locations-and-credentials.html,https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/manage-external-locations-and-credentials,https://docs.gcp.databricks.com/data-governance/unity-catalog/manage-external-locations-and-credentials.html
60,GOV-23,Governance,UC enabled Data warehouses,-1,Low,Use UC enabled Data warehouses,1,1,1,1,0,Check if disable_uc = true on warehouses,curl --netrc -X GET \ https://<workspace_url>/api/2.0/sql/warehouses,https://docs.databricks.com/sql/admin/create-sql-warehouse.html#advanced-options,https://learn.microsoft.com/en-us/azure/databricks/sql/admin/create-sql-warehouse#--advanced-options,https://docs.gcp.databricks.com/sql/admin/create-sql-warehouse.html#advanced-options
61,INFO-17,Informational,Serverless Compute,-1,Low,Enable Serverless Compute,1,1,0,0,0,Check if enable_serverless_compute != true on warehouses ,curl --netrc -X GET \ https://<workspace_url>/api/2.0/sql/config/warehouses,https://docs.databricks.com/sql/admin/serverless.html,https://learn.microsoft.com/en-us/azure/databricks/sql/admin/serverless,N/A
62,INFO-18,Informational,Delta Sharing CREATE_RECIPIENT and CREATE_SHARE permissions,-1,Low,Limit who has CREATE_RECIPIENT and CREATE_SHARE permissions on metastore,1,1,1,1,0,Check who has  CREATE_RECIPIENT and CREATE_SHARE permission on the metastore,curl --netrc -X GET \ https://<workspace_url>/api/2.1/unity-catalog/permissions/{securable_type}/{full_name},https://docs.databricks.com/data-sharing/create-recipient.html,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts#--migrate-from-legacy-to-new-global-init-scripts,https://docs.gcp.databricks.com/data-sharing/create-recipient.html
63,GOV-24,Governance,Legacy Global Init Scripts,-1,High,Databricks recommends that you migrate legacy scripts to the new global init scripts framework and then disable legacy scripts,1,1,0,1,0,Check workspace-conf for enableDeprecatedGlobalInitScripts setting,curl -n -X GET 'https://<workspace_url>/api/2.0/preview/workspace-conf?keys=enableDeprecatedGlobalInitScripts',https://docs.databricks.com/clusters/init-scripts.html#migrate-from-legacy-to-new-global-init-scripts,https://learn.microsoft.com/en-us/azure/databricks/clusters/init-scripts#--migrate-from-legacy-to-new-global-init-scripts,