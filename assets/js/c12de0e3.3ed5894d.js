"use strict";(self.webpackChunksat=self.webpackChunksat||[]).push([[422],{2362:(e,n,i)=>{i.d(n,{A:()=>D});var s=i(6540),t=i(4848);function r(e){const{mdxAdmonitionTitle:n,rest:i}=function(e){const n=s.Children.toArray(e),i=n.find((e=>s.isValidElement(e)&&"mdxAdmonitionTitle"===e.type)),r=n.filter((e=>e!==i)),a=i?.props.children;return{mdxAdmonitionTitle:a,rest:r.length>0?(0,t.jsx)(t.Fragment,{children:r}):null}}(e.children),r=e.title??n;return{...e,...r&&{title:r},children:i}}var a=i(4164),o=i(539),c=i(204);const l="admonition_xJq3",d="admonitionHeading_Gvgb",h="admonitionIcon_Rf37",u="admonitionContent_BuS1";function p({type:e,className:n,children:i}){return(0,t.jsx)("div",{className:(0,a.A)(c.G.common.admonition,c.G.common.admonitionType(e),l,n),children:i})}function m({icon:e,title:n}){return(0,t.jsxs)("div",{className:d,children:[(0,t.jsx)("span",{className:h,children:e}),n]})}function x({children:e}){return e?(0,t.jsx)("div",{className:u,children:e}):null}function j(e){const{type:n,icon:i,title:s,children:r,className:a}=e;return(0,t.jsxs)(p,{type:n,className:a,children:[s||i?(0,t.jsx)(m,{title:s,icon:i}):null,(0,t.jsx)(x,{children:r})]})}function g(e){return(0,t.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const f={icon:(0,t.jsx)(g,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function v(e){return(0,t.jsx)(j,{...f,...e,className:(0,a.A)("alert alert--secondary",e.className),children:e.children})}function A(e){return(0,t.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const b={icon:(0,t.jsx)(A,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function y(e){return(0,t.jsx)(j,{...b,...e,className:(0,a.A)("alert alert--success",e.className),children:e.children})}function k(e){return(0,t.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const w={icon:(0,t.jsx)(k,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function z(e){return(0,t.jsx)(j,{...w,...e,className:(0,a.A)("alert alert--info",e.className),children:e.children})}function T(e){return(0,t.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const C={icon:(0,t.jsx)(T,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function S(e){return(0,t.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const N={icon:(0,t.jsx)(S,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const R={icon:(0,t.jsx)(T,{}),title:(0,t.jsx)(o.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const P={...{note:v,tip:y,info:z,warning:function(e){return(0,t.jsx)(j,{...C,...e,className:(0,a.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,t.jsx)(j,{...N,...e,className:(0,a.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,t.jsx)(v,{title:"secondary",...e}),important:e=>(0,t.jsx)(z,{title:"important",...e}),success:e=>(0,t.jsx)(y,{title:"success",...e}),caution:function(e){return(0,t.jsx)(j,{...R,...e,className:(0,a.A)("alert alert--warning",e.className),children:e.children})}}};function D(e){const n=r(e),i=(s=n.type,P[s]||(console.warn(`No admonition component found for admonition type "${s}". Using Info as fallback.`),P.info));var s;return(0,t.jsx)(i,{...n})}},6884:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>c,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"installation/standard/azure","title":"Azure","description":"This guide will help you setup the Security Analysis Tool (SAT) on Azure Databricks.","source":"@site/docs/installation/standard/azure.mdx","sourceDirName":"installation/standard","slug":"/installation/standard/azure","permalink":"/security-analysis-tool/docs/installation/standard/azure","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"AWS","permalink":"/security-analysis-tool/docs/installation/standard/aws"},"next":{"title":"GCP","permalink":"/security-analysis-tool/docs/installation/standard/gcp"}}');var t=i(4848),r=i(8453),a=i(9030),o=i(2362);const c={sidebar_position:1},l="Azure",d={},h=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"App Registration",id:"app-registration",level:3},{value:"App Client Secrets",id:"app-client-secrets",level:3},{value:"Add Service Principal to Databricks",id:"add-service-principal-to-databricks",level:3},{value:"Installation",id:"installation",level:2},{value:"Credentials Needed",id:"credentials-needed",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"References",id:"references",level:2}];function u(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"azure",children:"Azure"})}),"\n",(0,t.jsxs)(n.p,{children:["This guide will help you setup the ",(0,t.jsx)(n.strong,{children:"Security Analysis Tool (SAT)"})," on Azure Databricks."]}),"\n",(0,t.jsx)(o.A,{type:"note",title:"Note",children:(0,t.jsxs)(n.p,{children:["SAT requires at least one SAT set up in a workspace per Azure ",(0,t.jsx)(n.strong,{children:"subscription"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(n.p,{children:"There are some pre-requisites that need to be met before you can setup SAT on Azure. Make sure you have the appropriate permissions in your Azure cloud account to create the resources mentioned below."}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["SAT is especially beneficial to customers on Databricks ",(0,t.jsx)(n.strong,{children:"Premium"})," or ",(0,t.jsx)(n.strong,{children:"Enterprise"})," tiers,  as most of the checks and recommendations involve security features that are only available in tiers above Standard."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"app-registration",children:"App Registration"}),"\n",(0,t.jsx)(n.p,{children:"The first step is to create an App Registration in Azure. This will allow SAT to authenticate with Azure services. Follow the steps below to create an App Registration:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Open the Azure portal and navigate to Microsoft Entra ID."}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.code,{children:"App registrations"})," and then click on ",(0,t.jsx)(n.code,{children:"New registration"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Enter a name for the App Registration and select the appropriate permissions. The minimum requirement is to have access in a single tenant."}),"\n"]}),"\n",(0,t.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg mb-6",children:(0,t.jsx)("img",{src:(0,a.Ay)("/img/azure_app_reg.png"),alt:"Account Console"})}),"\n",(0,t.jsx)(n.h3,{id:"app-client-secrets",children:"App Client Secrets"}),"\n",(0,t.jsx)(n.p,{children:"After creating the App Registration, you will need to create a client secret. This secret will be used to authenticate with Azure services. Follow the steps below to create a client secret:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Open the App Registration you created in the previous step."}),"\n",(0,t.jsxs)(n.li,{children:["Click on ",(0,t.jsx)(n.code,{children:"Certificates & secrets"})," and then click on ",(0,t.jsx)(n.code,{children:"New client secret"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Enter a description for the client secret and select the expiry date. Click on ",(0,t.jsx)(n.code,{children:"Add"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Copy the value of the client secret and save it in a secure location."}),"\n",(0,t.jsxs)(n.li,{children:['Please add the created app with "Reader" role into the subscription level via Access control (IAM) using Role assignments under your ',(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/role-based-access-control/role-assignments-portal#step-2-open-the-add-role-assignment-page",children:"subscription, Access control (IAM) section"})]}),"\n"]}),"\n",(0,t.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg mb-6",children:(0,t.jsx)("img",{src:(0,a.Ay)("/img/azure_role_assignment.png"),alt:"Account Console"})}),"\n",(0,t.jsx)(n.h3,{id:"add-service-principal-to-databricks",children:"Add Service Principal to Databricks"}),"\n",(0,t.jsx)(n.p,{children:"After creating the App Registration and client secret, you will need to add the App Registration as a service principal in Databricks. Follow the steps below to add the service principal:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Go to the ",(0,t.jsx)(n.a,{href:"https://accounts.azuredatabricks.net/",children:"Account Console"})]}),"\n",(0,t.jsxs)(n.li,{children:["On the left side bar menu, click on ",(0,t.jsx)(n.code,{children:"User management"})]}),"\n",(0,t.jsxs)(n.li,{children:["Select ",(0,t.jsx)(n.code,{children:"Service Principal"})," and then ",(0,t.jsx)(n.code,{children:"Add service principal"})]}),"\n",(0,t.jsxs)(n.li,{children:["Select ",(0,t.jsx)(n.code,{children:"Microsoft Entra ID Managed Application"})," as the service principal type."]}),"\n",(0,t.jsx)(n.li,{children:"Paste the App Client ID and create a new name for the service principal."}),"\n",(0,t.jsx)(n.li,{children:"Click Add."}),"\n",(0,t.jsxs)(n.li,{children:["The Service Principal must be granted the ",(0,t.jsx)(n.code,{children:"Account Admin"})," role. This role provides the ability to manage account-level settings and permissions."]}),"\n",(0,t.jsxs)(n.li,{children:["Assign the Workspace Admin Role: The Service Principal must be assigned the ",(0,t.jsx)(n.code,{children:"Workspace Admin"})," role for each workspace it will manage. This role provides the ability to manage workspace-level settings and permissions."]}),"\n",(0,t.jsxs)(n.li,{children:["Add to the Metastore Admin Group: The Service Principal must be added to the ",(0,t.jsx)(n.code,{children:"Metastore Admin"})," group or role. This role provides the ability to manage metastore-level settings and permissions."]}),"\n"]}),"\n",(0,t.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg mb-6",children:(0,t.jsx)("img",{src:(0,a.Ay)("/img/azure_ws.png"),alt:"Account Console"})}),"\n",(0,t.jsxs)(n.p,{children:["See the ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/admin/users-groups/service-principals#--databricks-and-microsoft-entra-id-formerly-azure-active-directory-service-principals",children:"Databricks documentation"})," for more information on adding service principals."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["The Service Principal requires an ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/admin/users-groups/service-principals#--assign-account-admin-roles-to-a-service-principal",children:"Accounts Admin role"}),", ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/admin/users-groups/service-principals#assign-a-service-principal-to-a-workspace-using-the-account-console",children:"Admin role"})," for ",(0,t.jsx)(n.strong,{children:"each workspace"})," and needs to be a member of the ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/manage-privileges/admin-privileges#who-has-metastore-admin-privileges",children:"metastore admin group"})," is required to analyze many of the APIs. Please ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/admin/users-groups/service-principals",children:"add this Service Princple"})," to ",(0,t.jsx)(n.strong,{children:"each workspace"})," so that SAT can access the APIs for analysis."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,t.jsx)(n.h3,{id:"credentials-needed",children:"Credentials Needed"}),"\n",(0,t.jsx)(n.p,{children:"To setup SAT on Azure, you will need the following credentials:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Databricks Account ID"}),"\n",(0,t.jsx)(n.li,{children:"Azure Tenant ID"}),"\n",(0,t.jsx)(n.li,{children:"Azure Subscription ID"}),"\n",(0,t.jsx)(n.li,{children:"Azure App Client ID (Obtained from App Registration)"}),"\n",(0,t.jsx)(n.li,{children:"Azure App Client Secret (Obtained from App Client Secrets)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"To execute the SAT follow these steps on your workstation or a compatible VM that has access to the internet and the Databricks workspace:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Clone the SAT repository locally"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"  git clone https://github.com/databricks-industry-solutions/security-analysis-tool.git\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Remember that the target workspace should have a ",(0,t.jsx)(n.a,{href:"https://docs.gcp.databricks.com/en/dev-tools/cli/profiles.html",children:"profile"})," in ",(0,t.jsx)(n.a,{href:"https://docs.gcp.databricks.com/en/dev-tools/cli/tutorial.html",children:"Databricks CLI"})]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Run the ",(0,t.jsx)(n.code,{children:"install.sh"})," script on your terminal."]}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"To ensure that the install.sh script is executable, you need to modify its permissions using the chmod command."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"  chmod +x install.sh\n  ./install.sh\n"})}),"\n",(0,t.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg mb-6",children:(0,t.jsx)("img",{src:(0,a.Ay)("/gif/terminal-azure.gif"),alt:"Account Console"})}),"\n",(0,t.jsxs)(n.p,{children:["Congratulations! \ud83c\udf89 You are now ready to start using the SAT. Please click ",(0,t.jsx)(n.a,{href:"/security-analysis-tool/docs/functionality",children:"here"})," for a detailed description on how to run and use it."]}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(n.p,{children:"Please review the FAQs and troubleshooting resources, including the diagnostic notebook provided to help verify your SAT setup."}),"\n",(0,t.jsx)(n.p,{children:"If you encounter issues during installation:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Double-check your credentials."}),"\n",(0,t.jsx)(n.li,{children:"Ensure you have the correct configurations and permissions for your Databricks environment."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If problems persist, feel free to contact us with your feedback or questions at ",(0,t.jsx)(n.a,{href:"mailto:sat@databricks.com",children:"sat@databricks.com"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app",children:"Azure App Registration"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/databricks/admin/users-groups/service-principals#--databricks-and-microsoft-entra-id-formerly-azure-active-directory-service-principals",children:"Databricks Service Principals"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>o});var s=i(6540);const t={},r=s.createContext(t);function a(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);